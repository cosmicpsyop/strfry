--- strfry.hoytech/golpe/rules.mk	2024-01-05 13:35:52.426935000 -0800
+++ strfry/golpe/rules.mk	2024-01-05 14:33:43.822237000 -0800
@@ -1,15 +1,34 @@
+ifeq ($(shell echo | gcc -E -dM - | grep -c __FreeBSD__),1)
+    __FreeBSD__ = 1
+endif
+
 APPS     ?=
 export APPS
 
 W        ?= -Wall
 OPT      ?= -O2 -g
 STD      ?= -std=c++20
+
+ifneq ($(origin __FreeBSD__), undefined)
+CXX      = g++
+CC       = cc
+MAKE     = gmake
+STD      += -stdlib=libc++
+endif
+
 CXXFLAGS += $(STD) $(OPT) $(W) -fPIC $(XCXXFLAGS) -DDOCOPT_HEADER_ONLY
 INCS     += -Iinclude -Ibuild -Isrc -Igolpe/external -Igolpe/external/lmdbxx/include -Igolpe/external/config/include -Igolpe/external/json/include -Igolpe/external/PEGTL/include -Igolpe/external/hoytech-cpp -Igolpe/external/docopt.cpp -Igolpe/external/loguru -Igolpe/external/parallel-hashmap
 LDLIBS   += golpe/external/uWebSockets/libuWS.a -ldl -lz -lcrypto -lssl -llmdb -pthread
 LDFLAGS  += -flto $(XLDFLAGS)
 SRCS    := golpe/logging.cpp build/main.cpp build/config.cpp $(wildcard src/*.cpp) $(wildcard $(foreach p,$(APPS),src/apps/$(p)/*.cpp))
 
+ifneq ($(origin __FreeBSD__), undefined)
+    INCS    += -I/usr/local/include  # Add FreeBSD-specific include paths
+    LDLIBS  += -linotify -lc++ -luv
+    NPROC = 2
+endif
+
+
 OBJS    := $(SRCS:.cpp=.o)
 DEPS    := $(SRCS:.cpp=.d)
 
@@ -25,7 +44,7 @@
 	$(CXX) $(OBJS) $(CMDOBJS) $(LDFLAGS) $(LDLIBS) -o $(BIN)
 
 golpe/external/uWebSockets/libuWS.a:
-	cd golpe/external/uWebSockets && make -j libuWS.a
+	cd golpe/external/uWebSockets && make -j$(NPROC) libuWS.a
 
 %.o : %.cpp build/golpe.h build/config.h build/defaultDb.h
 	$(CXX) $(CXXFLAGS) $(INCS) -MMD -MP -MT $@ -MF $*.d -c $< -o $@
